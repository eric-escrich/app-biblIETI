
<div class="headerContainer flex flex-col items-center justify-center text-center">
    <header class="w-4/5">
        <div class="flex flex-col items-center justify-center ">
            <a [routerLink]="['/inici']"><h1>BIBLIOTECA MARI CARMEN BRITO</h1></a>
        </div>
    </header>
</div>

@if (item) {
    <div class="p-20 flex flex-col gap-6 items-center justify-center">
        <div class="confCompteContainer">
            <div class="edicioCompteContainer">
                <div class="flex flex-col p-10 gap-10">
                    <div>
                        <h2 >{{ item.title }}</h2>
                        <h3 class="mt-0">Autor: {{ item.more_details.author }}</h3>
                        @if (item.more_details.type == 'book') {
                            <p>Editorial: {{ item.more_details.publisher }}</p>
                            <p>Any de publicació: {{ item.more_details.edition_date }}</p>
                            <p>Col·lecció: {{ item.more_details.colection }}</p>
                            <p>Nùmero de pàgines: {{ item.more_details.pages }}</p>
                            <p>CDU: {{ item.more_details.CDU }}</p>
                            <p>ISBN: {{ item.more_details.ISBN }}</p>
    
                        } @else if (item.more_details.type == 'cd'){
                            <p>Discogràfica: {{ item.more_details.discoraphy }}</p>
                            <p>Duració: {{ item.more_details.duration }}</p>
                            <p>Data de llançament: {{ item.more_details.edition_date }}</p>
                            <p>Estil: {{ item.more_details.style }}</p>
                        }
                        <p>Tipus de material: {{ item.material_type }}</p>
                    </div>
                    <div>
                        <h3>A LA BIBLIOTECA</h3>
                        <div class="card">
                            <p-table [value]="itemCopis">
                                <ng-template pTemplate="header">
                                    <tr>
                                        <th>ID</th>
                                        <th>Estat</th>
                                    </tr>
                                </ng-template>
                                <ng-template pTemplate="body" let-item>
                                    <tr>
                                        <td>{{ item.id }}</td>
                                        @if (item.status == 'Available') {
                                            <td>Disponible</td>
                                        } @else {
                                            <td>No disponible</td>
                                        }
                                    </tr>
                                </ng-template>
                            </p-table>
                        </div>
                    </div>

                    @if (role && (role == Role.BIBLIO || role == Role.ADMIN)) {
                        <div>
                            <h3>PRÈSTECS</h3>
                        
                            <form (ngSubmit)="sendForm()" method="post" class="flex flex-col gap-y-4">
                                <div class="flex-auto">
                                    <label for="icondisplay" class="font-bold block mb-2 mt-0">Item a prestar</label>
                                    <p-dropdown name="item" [options]="availableItems" [(ngModel)]="selectedItem" optionLabel="id" placeholder="Selecciona un item"></p-dropdown>
                                </div>
                                <div class="flex-auto">
                                    <label for="icondisplay" class="font-bold block mb-2 mt-0">Usuari que realitza el prèstec</label>
                                    <p-autoComplete
                                        name="user"
                                        [(ngModel)]="searchEmail"
                                        [suggestions]="users"
                                        (input)="onFilterChange()"
                                        [minLength]="3"
                                        field="email"
                                        placeholder="Selecciona un usuari"
                                    ></p-autoComplete>
                                </div>
             
                                <div class="flex-auto">
                                    <label for="icondisplay" class="font-bold block mb-2 mt-0">Data per tornar l'item</label>
                                    <p-calendar name="date" [(ngModel)]="fechaReserva" [iconDisplay]="'input'" [showIcon]="true" inputId="icondisplay"></p-calendar>
                                </div>
                                <p-button severity="fill-rounded" type="submit">Fer un prestec</p-button>
                            </form>
                        </div>
                    }
                </div>
            </div>
        </div>
        <p-button severity="min" [routerLink]="['/']">Tornar</p-button>

    </div>
}
